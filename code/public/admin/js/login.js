!function(s){var e=window.common;function d(){var a=t.data("captcha-url");t.find("img").attr("src",a+"?r="+Math.random())}s("#js_login_form").on("submit",function(a){a.preventDefault();var t=s(this).data("url"),n=s("#js_user_input").val().trim(),i=s("#js_password_input").val().trim();if(!n)return e.toast("请输入用户名"),!1;if(!i)return e.toast("请输入密码"),!1;var c={user:n,password:i};if(s("#js_captcha_input").is(":visible")){var r=(s("#js_captcha_input").val()||"").trim();if(!r)return e.toast("请输入验证码"),!1;c.captcha=r}e.loading("show");var o=s(this).data("callback-url");s.ajax({url:t,type:"POST",dataType:"JSON",headers:{"Content-Type":"application/json"},data:JSON.stringify(c)}).done(function(a){a.enabledCaptcha&&s("#js_captcha_container").addClass("on"),"100"===a.code?window.location.href=o:(!1===a.captcha&&d(),e.toast(a.desc))}).fail(function(a){0!==a.readyState&&e.toast("接口请求失败: "+(a.status||-1))}).always(function(){e.loading("hide")})});var t=s("#js_captcha").on("click",".js_captcha_change",d);!0===s("#js_captcha_container").data("enabled-captcha")&&d()}(window.jQuery);